This was mainly done as an exercise to make my life easier, so the code is pretty rough.